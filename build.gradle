apply plugin: 'java'
apply plugin: 'scala'
apply plugin: 'maven'
apply plugin: 'com.github.johnrengelman.shadow'

group = 'xyz.upperlevel.uppercore'
version = '1.3'

description = "Global API for Spigot plugins"

sourceCompatibility = 1.8
targetCompatibility = 1.8

buildscript {
    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
        mavenCentral()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:2.0.1'
    }
}

repositories {
    mavenLocal()
    mavenCentral()
    // Maven Snapshots
    maven {
        url "https://oss.sonatype.org/content/repositories/snapshots/";
    }
    // Spigot Api
    maven {
        url "https://hub.spigotmc.org/nexus/content/repositories/snapshots/"
    }
    // Placeholder Api
    maven {
        url "http://repo.extendedclip.com/content/repositories/placeholderapi/"
    }
    // Vault
    maven {
        url "http://nexus.hc.to/content/repositories/pub_releases"
    }
    // Metrics
    maven {
        url "http://repo.bstats.org/content/repositories/releases/"
    }
}

project.ext.mcVersion = '1.12-R0.1-SNAPSHOT'

dependencies {
    compileOnly 'org.scala-lang:scala-library:2.11.8'
    compileOnly "org.projectlombok:lombok:1.16.18"

    // Testing
    testCompile 'org.scalatest:scalatest_2.11:3.0.0'
    testCompile "junit:junit:4.12"

    compileOnly "org.spigotmc:spigot-api:${mcVersion}"
    testCompileOnly "org.spigotmc:spigot-api:${mcVersion}"
    compileOnly "org.bukkit:bukkit:${mcVersion}"
    testCompileOnly "org.bukkit:bukkit:${mcVersion}"

    compile "xyz.upperlevel.spigot.anvilgui:spigot-anvil-gui:1.3"
    compileOnly "me.clip:placeholderapi:2.0.8"
    compileOnly "net.milkbowl.vault:VaultAPI:1.6"

    // Metrics Api is compiled but relocated
    compile "org.bstats:bstats-bukkit:1.1"

    compileOnly "org.mongodb:mongo-java-driver:3.5.0"
    compileOnly "com.rethinkdb:rethinkdb-driver:2.3.3"
}

shadowJar {
    relocate "org.bstats", "${project.group}.libs.metrics"
}
project.tasks.assemble.dependsOn project.tasks.shadowJar
